# Polymarket ë°ì´í„° ìˆ˜ì§‘ ìµœì í™” ì „ëµ

## ğŸ¯ í˜„ì¬ ë¬¸ì œì 

1. **ìºì‹± ì—†ìŒ**: ëª¨ë“  ìš”ì²­ì´ `cache: 'no-store'`ë¡œ ì„¤ì •ë˜ì–´ ë§¤ë²ˆ API í˜¸ì¶œ
2. **Rate Limit ìœ„í—˜**: ë¶ˆí•„ìš”í•œ API í˜¸ì¶œë¡œ ì¸í•œ ì œí•œ ê°€ëŠ¥ì„±
3. **ëŠë¦° ì‘ë‹µ**: ë§¤ë²ˆ ì™¸ë¶€ APIë¥¼ ê¸°ë‹¤ë ¤ì•¼ í•¨
4. **ë¹„ìš© ì¦ê°€**: Vercel Serverless Functions ì‹¤í–‰ ì‹œê°„ ì¦ê°€

## âœ… ìµœì í™” ì „ëµ

### 1. **ê³„ì¸µì  ìºì‹± ì „ëµ (Hierarchical Caching)**

```
ì‚¬ìš©ì ìš”ì²­
  â†“
[1] í´ë¼ì´ì–¸íŠ¸ ìºì‹œ (ë¸Œë¼ìš°ì €) - 1ë¶„
  â†“ (ìºì‹œ ë¯¸ìŠ¤)
[2] Vercel Edge Cache (CDN) - 5ë¶„
  â†“ (ìºì‹œ ë¯¸ìŠ¤)
[3] Next.js API Route Cache - 1ë¶„
  â†“ (ìºì‹œ ë¯¸ìŠ¤)
[4] Polymarket API
```

### 2. **ë°ì´í„° íƒ€ì…ë³„ ìºì‹± ì „ëµ**

| ë°ì´í„° íƒ€ì… | TTL | ì´ìœ  |
|-----------|-----|------|
| **íƒœê·¸ ëª©ë¡** | 1ì‹œê°„ | ê±°ì˜ ë³€í•˜ì§€ ì•ŠìŒ |
| **ë§ˆì¼“ ëª©ë¡** | 1-5ë¶„ | ìì£¼ ë³€ê²½ë˜ì§€ë§Œ ì™„ì „ ì‹¤ì‹œê°„ ë¶ˆí•„ìš” |
| **í™€ë” ì •ë³´** | 30ì´ˆ-1ë¶„ | ìƒëŒ€ì ìœ¼ë¡œ ìì£¼ ë³€ê²½ |
| **ë§ˆì¼“ ìƒì„¸ ì •ë³´** | 1-2ë¶„ | ê°€ê²© ë“±ì´ ìì£¼ ë³€ê²½ |

### 3. **Next.js ìºì‹± ì˜µì…˜**

#### ì˜µì…˜ A: **ISR (Incremental Static Regeneration)** - ì¶”ì²œ
```typescript
// ì •ê¸°ì ìœ¼ë¡œ ì¬ìƒì„± (ë°±ê·¸ë¼ìš´ë“œ)
export const revalidate = 60 // 60ì´ˆë§ˆë‹¤ ì¬ìƒì„±
```

#### ì˜µì…˜ B: **Time-based Revalidation**
```typescript
fetch(url, {
  next: { revalidate: 300 } // 5ë¶„ ìºì‹œ
})
```

#### ì˜µì…˜ C: **On-demand Revalidation**
```typescript
// íŠ¹ì • ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ì¬ê²€ì¦
revalidatePath('/api/tech-markets')
```

## ğŸš€ êµ¬í˜„ ë°©ë²•

### ë°©ë²• 1: Next.js ISR ì‚¬ìš© (ê°€ì¥ íš¨ìœ¨ì )

**ì¥ì **:
- Vercel Edge Network í™œìš©
- ìë™ ìºì‹± ë° ì¬ê²€ì¦
- ë¹ ë¥¸ ì‘ë‹µ ì‹œê°„
- Rate limit ë³´í˜¸

**ë‹¨ì **:
- ìµœì‹  ë°ì´í„°ê°€ ì•½ê°„ ì§€ì—°ë  ìˆ˜ ìˆìŒ (1-5ë¶„)

### ë°©ë²• 2: Vercel KV ë˜ëŠ” Redis ìºì‹±

**ì¥ì **:
- ë” ì„¸ë°€í•œ ìºì‹œ ì œì–´
- ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ ê°„ ìºì‹œ ê³µìœ 
- ìˆ˜ë™ ìºì‹œ ë¬´íš¨í™” ê°€ëŠ¥

**ë‹¨ì **:
- ì¶”ê°€ ë¹„ìš©
- ì„¤ì • ë³µì¡ë„ ì¦ê°€

### ë°©ë²• 3: í´ë¼ì´ì–¸íŠ¸ ì¸¡ ìºì‹± + SWR/React Query

**ì¥ì **:
- ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ
- ì„œë²„ ë¶€í•˜ ê°ì†Œ
- ìë™ ì¬ê²€ì¦

**ë‹¨ì **:
- ì´ˆê¸° ë¡œë”©ì€ ì—¬ì „íˆ í•„ìš”

## ğŸ“Š ì¶”ì²œ ì „ëµ (í•˜ì´ë¸Œë¦¬ë“œ)

### ë‹¨ê¸° (ì¦‰ì‹œ ì ìš© ê°€ëŠ¥)
1. **Next.js revalidate ì‚¬ìš©**: `next: { revalidate: 300 }` (5ë¶„)
2. **íƒœê·¸ëŠ” ë” ê¸´ ìºì‹œ**: 1ì‹œê°„
3. **í™€ë” ì •ë³´ëŠ” ì§§ì€ ìºì‹œ**: 1ë¶„

### ì¤‘ê¸° (ì„±ëŠ¥ í–¥ìƒ)
1. **SWR ë˜ëŠ” React Query ë„ì…**: í´ë¼ì´ì–¸íŠ¸ ì¸¡ ìºì‹±
2. **Stale-while-revalidate íŒ¨í„´**: ìºì‹œëœ ë°ì´í„° ë¨¼ì € ë³´ì—¬ì£¼ê³  ë°±ê·¸ë¼ìš´ë“œ ì—…ë°ì´íŠ¸

### ì¥ê¸° (í™•ì¥ì„±)
1. **Vercel KV ë˜ëŠ” Upstash Redis**: ë¶„ì‚° ìºì‹±
2. **WebSocket ë˜ëŠ” Server-Sent Events**: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ (í•„ìš”ì‹œ)

## ğŸ”§ Rate Limit ê³ ë ¤ì‚¬í•­

**Polymarket ê³µì‹ Rate Limits** ([ë¬¸ì„œ](https://docs.polymarket.com/quickstart/introduction/rate-limits)):

### GAMMA API
- **GAMMA (General)**: 750 requests / 10ì´ˆ
- **GAMMA /markets**: 125 requests / 10ì´ˆ
- **GAMMA Tags**: 100 requests / 10ì´ˆ
- **GAMMA /events**: 100 requests / 10ì´ˆ

### Data API
- **Data API (General)**: 200 requests / 10ì´ˆ
- **Data API /trades**: 75 requests / 10ì´ˆ

### í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ ì—”ë“œí¬ì¸íŠ¸
- `/tags` (GAMMA): **100 requests / 10ì´ˆ** â†’ ìµœì†Œ 100ms ê°„ê²©
- `/markets` (GAMMA): **125 requests / 10ì´ˆ** â†’ ìµœì†Œ 80ms ê°„ê²©
- `/holders` (Data API): **200 requests / 10ì´ˆ** â†’ ìµœì†Œ 50ms ê°„ê²©

**ê¶Œì¥ì‚¬í•­**:
- íƒœê·¸ API: 1ì‹œê°„ ìºì‹œ (ê±°ì˜ ë³€í•˜ì§€ ì•ŠìŒ) â†’ ì´ˆë‹¹ 0.00003 ìš”ì²­
- ë§ˆì¼“ API: 5ë¶„ ìºì‹œ â†’ ì´ˆë‹¹ 0.003 ìš”ì²­ (ì•ˆì „)
- í™€ë” API: 1ë¶„ ìºì‹œ â†’ ì´ˆë‹¹ 0.017 ìš”ì²­ (ì•ˆì „)
- Rate limitì€ **throttling ë°©ì‹** (ìš”ì²­ì´ ì§€ì—°ë˜ì§€ë§Œ ê±°ë¶€ë˜ì§€ ì•ŠìŒ)
- ì—ëŸ¬ ì‹œ exponential backoff ì ìš© ê¶Œì¥

## ğŸ’¡ ì‹¤ì „ ì˜ˆì‹œ

### í˜„ì¬ (ë¹„íš¨ìœ¨ì )
```typescript
// ë§¤ë²ˆ API í˜¸ì¶œ
fetch(url, { cache: 'no-store' })
```

### ìµœì í™” í›„
```typescript
// 5ë¶„ ìºì‹œ, ë°±ê·¸ë¼ìš´ë“œ ì¬ê²€ì¦
fetch(url, { 
  next: { revalidate: 300 },
  headers: { 'Cache-Control': 'public, s-maxage=300, stale-while-revalidate=600' }
})
```

## ğŸ“ˆ ì˜ˆìƒ ì„±ëŠ¥ ê°œì„ 

| ë©”íŠ¸ë¦­ | í˜„ì¬ | ìµœì í™” í›„ | ê°œì„ ìœ¨ |
|--------|------|-----------|--------|
| API í˜¸ì¶œ ìˆ˜ | 100% | 5-10% | 90-95% ê°ì†Œ |
| í‰ê·  ì‘ë‹µ ì‹œê°„ | 500-1000ms | 50-100ms | 80-90% ê°œì„  |
| Rate limit ìœ„í—˜ | ë†’ìŒ | ë‚®ìŒ | - |
| Vercel ë¹„ìš© | ë†’ìŒ | ë‚®ìŒ | 80-90% ê°ì†Œ |
